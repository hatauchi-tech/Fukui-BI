# 福井BI - 損益計算書BIツール

福井鐵工株式会社向けの損益計算書データ可視化・分析ツールです。

## 概要

月次の損益計算書CSVデータを読み込み、部門別・科目別の業績を可視化します。経営判断に必要な主要指標（KPI）をダッシュボード形式で表示し、詳細な分析機能を提供します。

## 機能

### 全社サマリー
- 主要KPI表示（売上高、売上総利益、営業利益、経常利益、当期利益）
- 部門別売上構成比（円グラフ）
- 部門別営業利益比較（棒グラフ）
- 部門別サマリーテーブル

### 部門別分析
- 部門選択による詳細KPI表示
- 部門ごとの業績グラフ
- 複数部門の比較分析

### 原価分析
- 製造原価の内訳（材料費、労務費、経費）
- 販管費内訳分析
- 原価構成比の可視化

### 詳細データ表示
- 科目別テーブル表示
- フィルタリング・ソート機能
- CSVエクスポート

### ガイド
- 経営指標の計算方法
- グラフの見方
- 用語集

## 対象部門

| コード | 部課名 |
|-------|--------|
| 210 | 建機事業部 |
| 220 | 社会インフラ製作 |
| 230 | 社会インフラ架設 |
| 240 | 特機 |
| 250 | 民間リピート製作 |
| 260 | その他製作 |
| 270 | わかえ共通 |
| 900 | 共通 |

## 動作環境

- OS: Windows 10 / 11
- Python: 3.11 以上

## セットアップ

### 1. 初期セットアップ

```batch
setup.bat
```

以下が自動的に実行されます：
- Pythonバージョンの確認
- 依存パッケージのインストール

### 2. 依存パッケージ（手動インストールの場合）

```bash
pip install -r requirements.txt
```

主要パッケージ：
- pandas >= 2.0.0
- matplotlib >= 3.7.0
- ttkbootstrap >= 1.10.0

## 使い方

### 起動方法

**方法1: バッチファイルから起動**

```batch
損益計算書BI.bat
```

**方法2: コマンドラインから起動**

```bash
python -m src.main
```

### データの配置

1. 月次CSVファイルを「損益計算書」フォルダに配置
2. ファイル名は `YYYY_MM_損益計算書.csv` の形式
   - 例: `2025_07_損益計算書.csv`
3. アプリ起動時に自動で読み込まれます

## ディレクトリ構成

```
Fukui-BI/
├── 損益計算書BI.bat          # 起動用バッチファイル
├── setup.bat                 # 環境セットアップ
├── requirements.txt          # 依存パッケージ
├── 損益計算書/               # CSVデータ格納フォルダ
│   └── YYYY_MM_損益計算書.csv
├── src/
│   ├── main.py              # エントリーポイント
│   ├── app.py               # メインアプリケーション
│   ├── data_loader.py       # データ読み込み
│   ├── data_processor.py    # データ加工・集計
│   ├── components/          # UIコンポーネント
│   │   ├── theme.py         # テーマ設定
│   │   ├── kpi_card.py      # KPIカード
│   │   ├── charts.py        # グラフ
│   │   ├── data_table.py    # テーブル
│   │   └── responsive.py    # レスポンシブ対応
│   └── views/               # 画面ビュー
│       ├── dashboard.py     # 全社サマリー
│       ├── department.py    # 部門別分析
│       ├── cost_analysis.py # 原価分析
│       ├── detail_view.py   # 詳細データ
│       └── guide.py         # ガイド
└── tests/                   # テストファイル
```

## 技術スタック

| 技術 | 用途 |
|------|------|
| Python 3.11+ | アプリケーション開発 |
| tkinter + ttkbootstrap | GUI フレームワーク |
| pandas | データ処理・集計 |
| matplotlib | グラフ描画 |

## 画面構成

| タブ | 機能 |
|------|------|
| 全社サマリー | KPI + グラフ + 部門別一覧 |
| 部門別分析 | 部門選択による詳細分析 |
| 原価分析 | 原価構成・販管費分析 |
| 詳細データ | テーブル表示・エクスポート |
| ガイド | 指標解説・用語集 |

## 主要科目コード

| 科目 | コード |
|------|-------|
| 売上高（収入計） | 4199 |
| 売上原価 | 5399 |
| 売上総利益 | 5400 |
| 販管費 | 6299 |
| 営業利益 | 7000 |
| 経常利益 | 8000 |
| 当期利益 | 9000 |

## ライセンス

社内利用限定
